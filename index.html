<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>SignalsAI Beta - Signals to Accelerate Adoption</title>
    
    <!-- Web App Manifest -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="SignalsAI">
    
    <!-- Performance and compatibility -->
    <meta name="theme-color" content="#007DBA">
    <meta name="msapplication-navbutton-color" content="#007DBA">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Prevent zoom on input focus (iOS) -->
    <meta name="format-detection" content="telephone=no">
    
    <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <link href="app.css?v=8" rel="stylesheet" type="text/css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
</head>

<body>
    <div id="app">

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <div class="nav-tabs-left">
                <button class="nav-tab active" data-tab="home">
                    <i class="fas fa-home"></i>
                    Home
                </button>
                <button class="nav-tab" data-tab="recommendation-inbox">
                    <i class="fas fa-inbox"></i>
                    Recommendation Inbox
                </button>
                <button class="nav-tab" data-tab="my-portfolio">
                    <i class="fas fa-briefcase"></i>
                    My Portfolio
                </button>
                <button class="nav-tab" data-tab="actions">
                    <i class="fas fa-tasks"></i>
                    Action Plans
                </button>
                <button class="nav-tab" data-tab="whitespace">
                    <i class="fas fa-th"></i>
                    Whitespace
                </button>
                <button class="nav-tab" data-tab="signal-notes">
                    <i class="fas fa-sticky-note"></i>
                    Signal Notes
                </button>
                <button class="nav-tab" data-tab="about">
                    <i class="fas fa-info-circle"></i>
                    About
                </button>
                <!-- Hidden for now -->
                <!-- <button class="nav-tab" data-tab="signal-feed" style="display: none;">
                    <i class="fas fa-stream"></i>
                    Signal Feed
                </button> -->
            </div>
        </nav>

        <!-- Global Filters -->
        <div class="global-filters">
            <div class="filters-container">
                <div class="filters-grid">
                    <div class="filter-row">
                        <div class="filter-label">Contract Stage:</div>
                        <div class="filter-options">
                           <label class="filter-option">
                               <input type="radio" name="contractStage" value="all" checked>
                               <span class="checkbox-custom"></span>
                               <span class="option-text">All</span>
                           </label>
                           <label class="filter-option">
                               <input type="radio" name="contractStage" value="atBat">
                               <span class="checkbox-custom"></span>
                               <span class="option-text">AT BAT</span>
                           </label>
                            <label class="filter-option">
                                <input type="radio" name="contractStage" value="atBatPlus1">
                                <span class="checkbox-custom"></span>
                                <span class="option-text">AT BAT + 1</span>
                            </label>
                            <label class="filter-option">
                                <input type="radio" name="contractStage" value="adopt">
                                <span class="checkbox-custom"></span>
                                <span class="option-text">ADOPT</span>
                            </label>
                           <label class="filter-option">
                               <input type="radio" name="contractStage" value="onboard">
                               <span class="checkbox-custom"></span>
                               <span class="option-text">ONBOARD</span>
                           </label>
                        </div>
                    </div>
                    <div class="filter-row">
                        <div class="filter-label">Rank in MyBook:</div>
                        <div class="filter-options">
                            <label class="filter-option">
                                <input type="radio" name="rankInBook" value="all" checked>
                                <span class="checkbox-custom"></span>
                                <span class="option-text">All</span>
                            </label>
                            <label class="filter-option">
                                <input type="radio" name="rankInBook" value="tier1">
                                <span class="checkbox-custom"></span>
                                <span class="option-text">TIER 1</span>
                            </label>
                            <label class="filter-option">
                                <input type="radio" name="rankInBook" value="tier2">
                                <span class="checkbox-custom"></span>
                                <span class="option-text">TIER 2</span>
                            </label>
                            <label class="filter-option">
                                <input type="radio" name="rankInBook" value="tier3">
                                <span class="checkbox-custom"></span>
                                <span class="option-text">TIER 3</span>
                            </label>
                            <label class="filter-option">
                                <input type="radio" name="rankInBook" value="tier4">
                                <span class="checkbox-custom"></span>
                                <span class="option-text">TIER 4</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Home Tab -->
            <div id="home" class="tab-content active">
                <!-- Home content will be dynamically generated here -->
            </div>
            
            <!-- Portfolio Overview Tab -->
            <div id="portfolio-overview" class="tab-content">
                <!-- Overview content will be dynamically generated here -->
            </div>
            
            <!-- Whitespace Tab -->
            <div id="whitespace" class="tab-content">
                <!-- Whitespace content will be dynamically generated here -->
            </div>
            
            <!-- Signal Notes Tab -->
            <div id="signal-notes" class="tab-content">
                <div id="notes-content">
                    <!-- Notes content will be dynamically generated here -->
                </div>
            </div>
            
            <!-- About Tab -->
            <div id="about" class="tab-content">
                <div class="about-container">
                    <svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg" class="adoption-diagram">
                        <!-- Define gradients and styles -->
                        <defs>
                            <linearGradient id="pyramidGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#F5A623;stop-opacity:0.2" />
                                <stop offset="100%" style="stop-color:#D68910;stop-opacity:0.3" />
                            </linearGradient>
                            
                            <linearGradient id="coreGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#F5A623;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#D68910;stop-opacity:1" />
                            </linearGradient>
                            
                            <filter id="shadow">
                                <feDropShadow dx="0" dy="2" stdDeviation="4" flood-opacity="0.15"/>
                            </filter>
                        </defs>
                        
                        <!-- Background -->
                        <rect width="1200" height="800" fill="#fafafa"/>
                        
                        <!-- Title -->
                        <text x="600" y="50" font-family="Arial, sans-serif" font-size="32" font-weight="700" fill="#2d3748" text-anchor="middle">
                            Account Signals: The Adoption Accelerator
                        </text>
                        
                        <!-- Adoption Pyramid (Top) -->
                        <g id="pyramid">
                            <!-- PEOPLE -->
                            <rect x="150" y="120" width="200" height="70" rx="8" fill="url(#pyramidGrad)" stroke="#D68910" stroke-width="2" filter="url(#shadow)"/>
                            <text x="250" y="160" font-family="Arial, sans-serif" font-size="18" font-weight="600" fill="#4a5568" text-anchor="middle">PEOPLE</text>
                            
                            <!-- PROBLEMS -->
                            <rect x="425" y="120" width="200" height="70" rx="8" fill="url(#pyramidGrad)" stroke="#D68910" stroke-width="2" filter="url(#shadow)"/>
                            <text x="525" y="160" font-family="Arial, sans-serif" font-size="18" font-weight="600" fill="#4a5568" text-anchor="middle">PROBLEMS</text>
                            
                            <!-- PRODUCT -->
                            <rect x="700" y="120" width="200" height="70" rx="8" fill="url(#pyramidGrad)" stroke="#D68910" stroke-width="2" filter="url(#shadow)"/>
                            <text x="800" y="160" font-family="Arial, sans-serif" font-size="18" font-weight="600" fill="#4a5568" text-anchor="middle">PRODUCT</text>
                            
                            <!-- Converging arrows to center - solid and clean -->
                            <path d="M 250 190 Q 350 250 450 310" stroke="#D68910" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
                            <path d="M 525 190 L 525 310" stroke="#D68910" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
                            <path d="M 800 190 Q 700 250 575 310" stroke="#D68910" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
                        </g>
                        
                        <!-- Account Signals Core (Center) -->
                        <g id="core">
                            <!-- Data Inputs (left side) -->
                            <g id="inputs">
                                <!-- Gong -->
                                <rect x="40" y="300" width="110" height="50" rx="6" fill="white" stroke="#D68910" stroke-width="2" filter="url(#shadow)"/>
                                <text x="95" y="330" font-family="Arial, sans-serif" font-size="13" font-weight="600" fill="#4a5568" text-anchor="middle">Gong</text>
                                <path d="M 150 325 L 195 350" stroke="#D68910" stroke-width="2" marker-end="url(#arrowhead)"/>
                                
                                <!-- Health Grade -->
                                <rect x="40" y="365" width="110" height="50" rx="6" fill="white" stroke="#D68910" stroke-width="2" filter="url(#shadow)"/>
                                <text x="95" y="395" font-family="Arial, sans-serif" font-size="13" font-weight="600" fill="#4a5568" text-anchor="middle">Health Grade</text>
                                <path d="M 150 390 L 195 380" stroke="#D68910" stroke-width="2" marker-end="url(#arrowhead)"/>
                                
                                <!-- Customer Notes -->
                                <rect x="40" y="430" width="110" height="50" rx="6" fill="white" stroke="#D68910" stroke-width="2" filter="url(#shadow)"/>
                                <text x="95" y="460" font-family="Arial, sans-serif" font-size="13" font-weight="600" fill="#4a5568" text-anchor="middle">Customer Notes</text>
                                <path d="M 150 455 L 195 410" stroke="#D68910" stroke-width="2" marker-end="url(#arrowhead)"/>
                            </g>
                            
                            <rect x="200" y="310" width="525" height="140" rx="12" fill="url(#coreGrad)" filter="url(#shadow)"/>
                            
                            <!-- Account Signals Logo (left side) -->
                            <g id="logo" transform="translate(250, 380)">
                                <!-- Outer ring segments -->
                                <circle cx="0" cy="0" r="45" fill="none" stroke="#FFF4E6" stroke-width="8" opacity="0.4" stroke-dasharray="28 254" stroke-dashoffset="0"/>
                                <circle cx="0" cy="0" r="45" fill="none" stroke="#FFDBA8" stroke-width="8" opacity="0.5" stroke-dasharray="42 240" stroke-dashoffset="28"/>
                                <circle cx="0" cy="0" r="45" fill="none" stroke="#FFE5B8" stroke-width="8" opacity="0.6" stroke-dasharray="56 226" stroke-dashoffset="70"/>
                                <circle cx="0" cy="0" r="45" fill="none" stroke="#F5A623" stroke-width="8" stroke-dasharray="70 212" stroke-dashoffset="126"/>
                                <circle cx="0" cy="0" r="45" fill="none" stroke="#D68910" stroke-width="8" stroke-dasharray="56 226" stroke-dashoffset="196"/>
                                <circle cx="0" cy="0" r="45" fill="none" stroke="#8B5A0A" stroke-width="8" stroke-dasharray="32 250" stroke-dashoffset="252"/>
                                <!-- Inner white circle -->
                                <circle cx="0" cy="0" r="32" fill="white" opacity="0.95"/>
                                <!-- ACCOUNT SIGNAL text in logo -->
                                <text x="0" y="-6" font-family="Arial, sans-serif" font-size="9" font-weight="700" fill="#F5A623" text-anchor="middle">ACCOUNT</text>
                                <text x="0" y="8" font-family="Arial, sans-serif" font-size="9" font-weight="700" fill="#2d3748" text-anchor="middle">SIGNAL</text>
                            </g>
                            
                            <text x="480" y="345" font-family="Arial, sans-serif" font-size="24" font-weight="700" fill="white" text-anchor="middle">
                                ACCOUNT SIGNALS
                            </text>
                            
                            <!-- Process flow -->
                            <g id="process">
                                <circle cx="360" cy="395" r="32" fill="white" opacity="0.25"/>
                                <text x="360" y="380" font-family="Arial, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">DETECT</text>
                                <text x="360" y="410" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle" opacity="0.9">Signals</text>
                                
                                <path d="M 395 395 L 430 395" stroke="white" stroke-width="2" marker-end="url(#arrowheadWhite)"/>
                                
                                <circle cx="465" cy="395" r="32" fill="white" opacity="0.25"/>
                                <text x="465" y="380" font-family="Arial, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">RECOMMEND</text>
                                <text x="465" y="410" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle" opacity="0.9">AI Plays</text>
                                
                                <path d="M 500 395 L 535 395" stroke="white" stroke-width="2" marker-end="url(#arrowheadWhite)"/>
                                
                                <circle cx="570" cy="395" r="32" fill="white" opacity="0.25"/>
                                <text x="570" y="380" font-family="Arial, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">EXECUTE</text>
                                <text x="570" y="410" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle" opacity="0.9">Action</text>
                            </g>
                        </g>
                        
                        <!-- Adoption Lifecycle (Bottom) -->
                        <g id="lifecycle">
                            <path d="M 480 450 L 480 510" stroke="#D68910" stroke-width="2.5" fill="none" marker-end="url(#arrowhead)"/>
                            
                            <!-- ONBOARD -->
                            <rect x="150" y="520" width="220" height="140" rx="8" fill="white" stroke="#D68910" stroke-width="2" filter="url(#shadow)"/>
                            <text x="260" y="555" font-family="Arial, sans-serif" font-size="20" font-weight="700" fill="#D68910" text-anchor="middle">ONBOARD</text>
                            <text x="260" y="585" font-family="Arial, sans-serif" font-size="13" fill="#4a5568" text-anchor="middle">Detect blockers early</text>
                            <text x="260" y="610" font-family="Arial, sans-serif" font-size="12" fill="#718096" text-anchor="middle">Missing first value,</text>
                            <text x="260" y="630" font-family="Arial, sans-serif" font-size="12" fill="#718096" text-anchor="middle">unconfigured connectors</text>
                            
                            <!-- Arrow -->
                            <path d="M 370 590 L 405 590" stroke="#D68910" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
                            
                            <!-- ADOPT -->
                            <rect x="405" y="520" width="220" height="140" rx="8" fill="white" stroke="#D68910" stroke-width="2" filter="url(#shadow)"/>
                            <text x="515" y="555" font-family="Arial, sans-serif" font-size="20" font-weight="700" fill="#D68910" text-anchor="middle">ADOPT</text>
                            <text x="515" y="585" font-family="Arial, sans-serif" font-size="13" fill="#4a5568" text-anchor="middle">Recommend plays</text>
                            <text x="515" y="610" font-family="Arial, sans-serif" font-size="12" fill="#718096" text-anchor="middle">Improve feature use,</text>
                            <text x="515" y="630" font-family="Arial, sans-serif" font-size="12" fill="#718096" text-anchor="middle">education, credit pacing</text>
                            
                            <!-- Arrow -->
                            <path d="M 625 590 L 660 590" stroke="#D68910" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
                            
                            <!-- EXPAND -->
                            <rect x="660" y="520" width="220" height="140" rx="8" fill="white" stroke="#D68910" stroke-width="2" filter="url(#shadow)"/>
                            <text x="770" y="555" font-family="Arial, sans-serif" font-size="20" font-weight="700" fill="#D68910" text-anchor="middle">EXPAND</text>
                            <text x="770" y="585" font-family="Arial, sans-serif" font-size="13" fill="#4a5568" text-anchor="middle">Plan new use cases</text>
                            <text x="770" y="610" font-family="Arial, sans-serif" font-size="12" fill="#718096" text-anchor="middle">Cross-department</text>
                            <text x="770" y="630" font-family="Arial, sans-serif" font-size="12" fill="#718096" text-anchor="middle">engagement</text>
                        </g>
                        
                        <!-- Measure feedback loop -->
                        <path d="M 880 550 Q 980 420 720 350" stroke="#8B5A0A" stroke-width="3" fill="none" marker-end="url(#arrowheadBrown)"/>
                        <text x="970" y="470" font-family="Arial, sans-serif" font-size="13" font-weight="600" fill="#8B5A0A">MEASURE</text>
                        
                        <!-- KPI Callout -->
                        <g id="kpi-box">
                            <rect x="920" y="580" width="240" height="140" rx="8" fill="white" stroke="#D68910" stroke-width="2" filter="url(#shadow)"/>
                            <text x="1040" y="610" font-family="Arial, sans-serif" font-size="14" font-weight="700" fill="#D68910" text-anchor="middle">KEY OUTCOMES</text>
                            <text x="1040" y="640" font-family="Arial, sans-serif" font-size="12" fill="#4a5568" text-anchor="middle">+10% consumption lift</text>
                            <text x="1040" y="665" font-family="Arial, sans-serif" font-size="12" fill="#4a5568" text-anchor="middle">+4.5% GRR improvement</text>
                            <text x="1040" y="690" font-family="Arial, sans-serif" font-size="12" fill="#4a5568" text-anchor="middle">+12% influenced upsells</text>
                            <text x="1040" y="715" font-family="Arial, sans-serif" font-size="12" fill="#4a5568" text-anchor="middle">+20% play efficiency</text>
                        </g>
                        
                        <!-- Tagline -->
                        <text x="600" y="770" font-family="Arial, sans-serif" font-size="14" font-style="italic" fill="#718096" text-anchor="middle">
                            The connective tissue of Domo's Adoption Engine â€” guiding from signal to strategy to success
                        </text>
                        
                        <!-- Arrow markers -->
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#D68910" />
                            </marker>
                            <marker id="arrowheadWhite" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="white" />
                            </marker>
                            <marker id="arrowheadBrown" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#8B5A0A" />
                            </marker>
                        </defs>
                    </svg>
                </div>
            </div>
            
            <!-- Recommendation Inbox Tab -->
            <div id="recommendation-inbox" class="tab-content">
                <!-- Inbox content will be dynamically generated here -->
            </div>
            
            <!-- Signal Feed Tab -->
            <div id="signal-feed" class="tab-content">
                <!-- Top Summary Bar -->
                <div class="feed-summary-bar">
                    <div class="summary-content">
                        <i class="fas fa-bell summary-icon"></i>
                        <span class="summary-text" id="feed-summary-text">Loading...</span>
                    </div>
                </div>

                <!-- Controls Row -->
                <div class="feed-controls-row">
                    <!-- Filters Section -->
                    <div class="feed-filters">
                        <select id="categoryFilter" class="filter-select">
                            <option value="all">All Categories</option>
                            <option value="risk">Risk</option>
                            <option value="opportunity">Opportunity</option>
                            <option value="enrichment">Enrichment</option>
                        </select>
                        
                        <select id="priorityFilter" class="filter-select">
                            <option value="all">All Priorities</option>
                            <option value="High">High</option>
                            <option value="Medium">Medium</option>
                            <option value="Low">Low</option>
                        </select>
                        
                        <div class="search-container">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" 
                                   id="feedSearchInput" 
                                   class="search-input" 
                                   placeholder="Search by account name...">
                        </div>
                        
                        <select id="feedSortSelect" class="filter-select sort-select">
                            <option value="priority">Sort: Priority</option>
                            <option value="confidence">Sort: Confidence</option>
                            <option value="lastUpdated">Sort: Last Updated</option>
                            <option value="account">Sort: Account</option>
                        </select>
                    </div>
                    
                    <!-- Segmented Toggle -->
                    <div class="feed-toggle-container">
                        <div role="tablist" class="segmented-toggle" aria-label="Feed view toggle">
                            <button role="tab" 
                                    id="signals-tab-btn" 
                                    class="toggle-button" 
                                    aria-selected="false"
                                    aria-controls="signalsList"
                                    data-feed-mode="signals">
                                <i class="fas fa-signal"></i> Signals
                            </button>
                            <button role="tab" 
                                    id="actions-tab-btn" 
                                    class="toggle-button active" 
                                    aria-selected="true"
                                    aria-controls="signalsList"
                                    data-feed-mode="actions">
                                <i class="fas fa-tasks"></i> Actions
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Section Heading -->
                <div class="feed-section-header">
                    <h2 class="section-title" id="feedSectionTitle">Recommended Actions</h2>
                    <span class="item-count" id="feedItemCount">0 actions</span>
                </div>

                <!-- Feed List Container -->
                <div id="signalsList" class="signals-list feed-list">
                    <!-- Items will be populated here by SignalRenderer or ActionFeedRenderer -->
                </div>
            </div>

            <!-- My Portfolio Tab -->
            <div id="my-portfolio" class="tab-content">
                <!-- Dashboard Summary Cards -->
                <div class="portfolio-dashboard-cards">
        <div class="dashboard-card attention-card">
            <div class="card-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="card-content">
                <div class="card-title">Risks</div>
                <div class="card-value" id="requiresAttentionCount">6</div>
                <div class="card-description">Accounts with risk signals</div>
            </div>
            <div class="card-filter" id="riskFilter" data-filter-type="risk">
                <i class="fas fa-filter"></i>
            </div>
        </div>
        <div class="dashboard-card priority-card">
            <div class="card-icon">
                <i class="fas fa-chart-line"></i>
            </div>
            <div class="card-content">
                <div class="card-title">Opportunities</div>
                <div class="card-value" id="highPriorityDashboard">6</div>
                <div class="card-description">Accounts with opportunity signals</div>
            </div>
            <div class="card-filter" id="opportunityFilter" data-filter-type="opportunity">
                <i class="fas fa-filter"></i>
            </div>
        </div>
                    <div class="dashboard-card accounts-card">
                        <div class="card-icon">
                            <i class="fas fa-building"></i>
                        </div>
                        <div class="card-content">
                            <div class="card-title">Active Accounts</div>
                            <div class="card-value" id="activeAccountsCount">6</div>
                            <div class="card-description">with AI Recommendations</div>
                        </div>
                    </div>
                </div>



                <div id="accountsList" class="accounts-list">
                    <!-- Account cards will be populated here -->
                </div>
            </div>

            <!-- Action Plans Tab -->
            <div id="actions" class="tab-content">
                <div class="actions-overview">
                    <div class="overview-cards">
                        <div class="overview-card">
                            <div class="card-value" id="totalActions">0</div>
                            <div class="card-label">Total Action Plans</div>
                        </div>
                        <div class="overview-card">
                            <div class="card-value" id="pendingActions">0</div>
                            <div class="card-label">Pending</div>
                        </div>
                        <div class="overview-card">
                            <div class="card-value" id="inProgressActions">0</div>
                            <div class="card-label">In Progress</div>
                        </div>
                        <div class="overview-card">
                            <div class="card-value" id="projectedImpact">0</div>
                            <div class="card-label">Completed</div>
                        </div>
                    </div>
                </div>

                <div class="actions-filters">
                    <button class="filter-btn active" data-filter="all">All Action Plans</button>
                    <button class="filter-btn" data-filter="pending">Pending</button>
                    <button class="filter-btn" data-filter="in-progress">In Progress</button>
                    <button class="filter-btn" data-filter="completed">Completed</button>
                </div>

                <div id="actionsList" class="actions-list">
                    <!-- Action items will be populated here -->
                </div>
            </div>
        </main>

        <!-- Create Action Plan Drawer -->
        <div id="createPlanDrawerBackdrop" class="drawer-backdrop"></div>
        <div id="createPlanDrawer" class="drawer">
            <div class="drawer-content">
                <div class="drawer-header">
                    <h2><i class="fas fa-lightbulb"></i> Create Action Plan</h2>
                    <button class="drawer-close" id="closePlanDrawer">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="drawer-body">
                    <!-- Plan creation form will be populated here -->
                </div>
                <div class="drawer-footer">
                    <button class="btn btn-secondary" id="cancelPlan">Cancel</button>
                    <button class="btn btn-primary" id="createPlan">Create Plan</button>
                </div>
            </div>
        </div>

        <!-- Signal Details Drawer -->
        <div id="signalDrawer" class="drawer">
            <div class="drawer-content">
                <div class="drawer-header">
                    <h2 id="signalTitle">Signal Details</h2>
                    <button class="drawer-close" id="closeSignalDrawer">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="drawer-body" id="signalDetails">
                    <!-- Signal details will be populated here -->
                </div>
                <div class="drawer-footer">
                    <button class="btn btn-secondary" id="drawerLikeSignal">
                        <i class="fas fa-thumbs-up"></i> Like
                    </button>
                    <button class="btn btn-secondary" id="drawerNotAccurateSignal">
                        <i class="fas fa-thumbs-down"></i> Not Accurate
                    </button>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="loading-overlay">
            <div class="loading-spinner">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Loading SignalsAI data...</p>
            </div>
        </div>

        <!-- Add to Plan Drawer -->
        <div id="addToPlanDrawer" class="plan-drawer">
            <div class="plan-drawer-content">
                <div class="plan-drawer-header">
                    <h2>Add Action to Plan</h2>
                    <button class="plan-drawer-close" id="closePlanDrawerBtn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="plan-drawer-body">
                    <div class="recommended-action-section">
                        <h3>Recommended Action</h3>
                        <div id="drawerActionTitle" class="action-title-display"></div>
                    </div>
                    
                    <div class="toolbox-plays-section">
                        <h3>Toolbox of Plays</h3>
                        <div id="drawerPlaysContainer" class="drawer-plays-container">
                            <!-- Plays will be loaded here -->
                        </div>
                    </div>
                    
                    <div class="plan-details-section">
                        <h3>Plan Details</h3>
                        <textarea id="drawerPlanDetails" placeholder="Add your comments or notes about this action plan..." rows="4"></textarea>
                    </div>
                </div>
                
                <div class="plan-drawer-footer">
                    <div id="drawerErrorMessage" class="plan-drawer-error" style="display: none;"></div>
                    <div class="plan-drawer-buttons">
                        <button class="btn btn-secondary" id="cancelPlanBtn">Cancel</button>
                        <button class="btn btn-primary" id="createPlanBtn">Create Plan</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="addToPlanDrawerBackdrop" class="plan-drawer-backdrop"></div>
    </div>


    <!-- domo.js optional utils -->
    <script src="https://unpkg.com/ryuu.js@4.6.0/dist/domo.js"
        integrity="sha384-YYsd9wQ+wDlUWhvpfGdptxmNYIqBC+52oJtWgPKJadbs3sSFTY/+ZotPbEHTTRWz"
        crossorigin="anonymous"></script>

    <!-- Flux Architecture (must load first) -->
    <script src="js/flux/Dispatcher.js"></script>
    <script src="js/flux/Store.js"></script>
    <script src="js/flux/Actions.js"></script>
    <script src="js/flux/SignalsStore.js"></script>
    <script src="js/GlobalFilters.js"></script>
    
    <!-- Flux Repositories and Services -->
    <script src="js/flux/repositories/SignalsRepository.js"></script>
    <script src="js/flux/services/FeedbackService.js"></script>
    <script src="js/flux/services/ActionFeedbackService.js"></script>
    <script src="js/flux/services/CommentsService.js"></script>
    <script src="js/flux/services/ActionPlansService.js"></script>
    <script src="js/flux/services/NotesService.js"></script>
    <script src="js/flux/services/SignalDimensionService.js"></script>
    
    <!-- Flux Testing (Development Only) -->
    <script src="js/flux/FluxTest.js"></script>

    <!-- Core Services (Notification service remains as it's used by UI) -->
    <script src="js/services/NotificationService.js"></script>

    <!-- Event Handling -->
    <!-- EventHandlers.js removed - now using Flux controllers -->

    <!-- Renderers (must load after services they depend on) -->
    <script src="js/utils/FormatUtils.js"></script>
    <script src="js/utils/StatusUtils.js"></script>
    <script src="js/utils/SecurityUtils.js"></script>
    <script src="js/utils/VirtualScrollManager.js"></script>
    <script src="js/SignalRenderer.js"></script>
    <script src="js/ActionFeedRenderer.js"></script>
    <script src="js/RecommendationInboxRenderer.js"></script>
    <script src="js/PortfolioRenderer.js?v=9"></script>
    <script src="js/PortfolioOverviewRenderer.js"></script>
    <script src="js/HomeRenderer.js"></script>
    <script src="js/ActionsRenderer.js"></script>
    <script src="js/WhitespaceRenderer.js?v=5"></script>
    <script src="js/NotesRenderer.js"></script>
    
    <!-- Flux Controllers (must load after renderers and Flux infrastructure) -->
    <script src="js/controllers/FeedbackController.js"></script>
    <script src="js/controllers/CommentsController.js"></script>
    <script src="js/controllers/SignalsController.js"></script>
    <script src="js/controllers/PortfolioController.js"></script>
    <script src="js/controllers/PortfolioOverviewController.js"></script>
    <script src="js/controllers/HomeController.js"></script>
    <script src="js/controllers/RecommendationInboxController.js"></script>
    <script src="js/controllers/NotesController.js"></script>
    <script src="js/controllers/AppController.js"></script>


    <!-- Application Initialization -->
    <script>
        // Initialize new Flux-based AppController
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('ðŸš€ SignalsAI v8.0 Flux architecture initializing...');
            try {
                window.appController = new AppController();
                await window.appController.init();
                console.log('âœ… SignalsAI Flux architecture initialized successfully!');
            } catch (error) {
                console.error('âŒ Failed to initialize Flux architecture:', error);
            }
            
            // Set up the create plan button handler
            document.addEventListener('click', async (e) => {
                if (e.target.id === 'createPlan') {
                    // Use the Flux ActionPlansService instead
                    const drawerContent = document.querySelector('.drawer-body');
                    const titleInput = drawerContent?.querySelector('input[placeholder*="title"]');
                    const descriptionInput = drawerContent?.querySelector('textarea');
                    
                    if (titleInput && titleInput.value) {
                        const signalId = window.appController?.selectedSignalId || null;
                        
                        // Get accountId from signalId using SignalsStore (eliminates fragile inference)
                        let accountId = null;
                        if (signalId && window.signalsStore) {
                            try {
                                const signal = window.signalsStore.getState().signalsById.get(signalId);
                                accountId = signal?.account_id;
                            } catch (error) {
                                console.warn('Could not get accountId from signalId:', error);
                            }
                        }
                        
                        if (accountId) {
                            await ActionPlansService.createActionPlan(
                                signalId,
                                accountId, // Pass accountId directly instead of requiring inference
                                titleInput.value,
                                descriptionInput?.value || ''
                            );
                            dispatcher.dispatch(Actions.closePlanDrawer());
                        } else {
                            dispatcher.dispatch(Actions.showMessage('Unable to determine account for action plan', 'error'));
                        }
                    } else {
                        dispatcher.dispatch(Actions.showMessage('Please enter a plan title', 'error'));
                    }
                }
                if (e.target.id === 'cancelPlan' || e.target.id === 'closePlanDrawer') {
                    dispatcher.dispatch(Actions.closePlanDrawer());
                }
            });
        });
    </script>
</body>

</html>